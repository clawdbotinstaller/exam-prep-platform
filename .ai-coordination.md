# AI Coordination File

**Last Updated**: 2026-02-07T17:30:00Z
**Project**: Arkived (Exam Prep Platform)

## Current Status

### Claude (Active)
- **Task**: Removing all hardcoded data, adding error handling with apology messages
- **Files Modified**:
  - frontend/src/sections/QuestionSpotlight.tsx (removed fallback, added ErrorApology)
  - frontend/src/sections/TopicDeepDive.tsx (removed fallback, added ErrorApology)
  - frontend/src/sections/TopicBreakdown.tsx (removed fallback, added ErrorApology)
  - frontend/src/sections/ContactSection.tsx (added API integration)
  - frontend/src/components/ErrorApology.tsx (new)
  - worker/src/index.ts (added POST /api/contact endpoint)
- **Status**: completed
- **Blocked By**: None

### Codex (Next)
- **Task**: Available for frontend/backend tasks
- **Status**: waiting

## Recent Changes (Last 10)

1. **[CLAUDE]** Created ErrorApology component for consistent error UX
2. **[CLAUDE]** Removed hardcoded fallback data from QuestionSpotlight
3. **[CLAUDE]** Removed hardcoded fallback data from TopicDeepDive
4. **[CLAUDE]** Removed hardcoded fallback data from TopicBreakdown
5. **[CLAUDE]** Added POST /api/contact endpoint to worker
6. **[CLAUDE]** Wired ContactSection form to backend API
7. **[CLAUDE]** Installed katex and react-katex for LaTeX rendering
8. **[CLAUDE]** Fixed user.plan → has_unlimited schema mismatch
9. **[CLAUDE]** Created topics table & seeded 15 Calculus 2 topics
10. **[CLAUDE]** Fixed questions endpoint routing

## API Status

| Endpoint | Status | Notes |
|----------|--------|-------|
| /api/health | ✅ Working | |
| /api/auth/login | ✅ Working | test@example.com / test123 |
| /api/auth/me | ✅ Working | |
| /api/credits/balance | ✅ Working | |
| /api/courses | ✅ Working | |
| /api/courses/:id/topics | ✅ Working | 15 topics seeded |
| /api/courses/:id/questions | ✅ Working | Returns LaTeX content |
| /api/midterm/generate | ✅ Working | Defaults to calc2 |

## Database Schema

### users
- id, email, password_hash, credits, has_unlimited, unlimited_until, credits_reset_at

### topics (15 seeded)
- integration_by_parts, trig_integrals, trig_substitution, partial_fractions, improper_integrals
- arc_length, surface_area, center_of_mass
- series_basics, integral_test, comparison_tests, alternating_series, ratio_root_tests, power_series, taylor_series

### questions
- 33 questions from 5 MTH240 exams
- question_text contains LaTeX like `$\int \tan^{5}(x) \sec^{6}(x) dx$`

## Environment

- **Worker URL**: https://arkived.clawdbotinstaller.workers.dev
- **Database**: testament-db (D1)
- **Test Users**:
  - test@example.com / test123 (1 credit)
  - unlimited@example.com / test123 (unlimited)

## Handoff Notes

### For Next AI Instance

1. **LaTeX Rendering**: Just installed react-katex. Questions now render properly with `<LatexRenderer tex={...} />`

2. **If questions fail to load**: Check:
   - API endpoint: /api/courses/calc2/questions?limit=N
   - Auth token required
   - Questions exist in DB (33 seeded)

3. **Known Issues**:
   - Frontend build can fail on unused variables (TypeScript strict)
   - Some sections still use hardcoded data
   - Contact form not wired to backend yet

4. **Next Priority Tasks**:
   - [x] Fix ContactSection form submission (endpoint exists at /api/contact)
   - [ ] Add proper error boundaries
   - [ ] Test midterm generation flow end-to-end
   - [ ] Stripe integration for payments

## Communication Protocol

1. **Before Starting**: Read this file, check git status
2. **After Changes**: Update this file with your changes
3. **Git Commits**: Use prefix `[CLAUDE]` or `[CODEX]` in commit messages
4. **Conflicts**: If both working, use different branches

## Commands

```bash
# Check API health
curl https://arkived.clawdbotinstaller.workers.dev/api/health

# Build frontend
cd frontend && npm run build

# Deploy worker
cd worker && wrangler deploy

# Check DB tables
wrangler d1 execute testament-db --remote --command="SELECT name FROM sqlite_master WHERE type='table'"
```
